
<!--
   Author : Anthony John Ripa
   Date : 5/25/2015
   Demo for PlaceValue : a datatype for representing base agnostic arithmetic via numbers whose digits are real
-->

<!DOCTYPE html>
<html>
<head>
    <title>Base Calculator</title>
    <script type="text/javascript" src='http://code.jquery.com/jquery-latest.js'></script>
    <script type="text/javascript">
        window.jQuery || document.write("<script src='../../js/jquery.js'><" + "/script>")
    </script>
    <script type="text/javascript" src='wholeplacevalue.js'></script>
    <script type="text/javascript" src='placevalue.js'></script>
    <style>
        output { margin: 150px; }
        body,input { font-family:"Arial Unicode MS"}
        table { border-spacing: 0; float: left; margin: 10px; }
        .line td { border-bottom: 1pt solid black; }
        input { text-align: right; }
    </style>
</head>
<body>
    <select onchange="clean()"><option onclick="f=placevalue">PlaceValue</option><option onclick="f=wholeplacevalue">WholePlaceValue</option></select>
    <br />
    <br />
    <table>
        <tr><td></td><td><input id='a' value='1' onchange="$(this).removeAttr('data-val')" /></td><td></td><td><output id="ao"></output></td></tr>
        <tr class="line"><td><select id='op'><option>+</option><option>-</option><option>x</option><option>/</option><option>⊗</option><option>⊘</option><option>⊖</option><option>⊕</option></select></td><td><input id='b' value='11' onchange="$(this).removeAttr('data-val')"></td><td><button onclick="moveanswer('#b','#a')">↑</button></td><td><output id="bo"></output></td></tr>
        <tr><td><button onclick="compute()">=</button></td><td><input id='c' /></td><td><button onclick="moveanswer('#c','#b')">↑</button></td><td><output id="co"></output></td></tr>
    </table>
    <script type="text/javascript">
        var f = placevalue;
        function compute() {
            var a = getinput('#a');
            var b = getinput('#b');
            var c = [a.add, a.sub, a.times, a.divide, a.pointtimes, a.pointdivide, a.pointsub, a.pointadd][$('#op')[0].selectedIndex].call(a, b);
            output(a, b, c);
            function getinput(elem) { return new f($(elem).attr('data-val') || $(elem).val()); }
            function output(a, b, c) {
                $('#c').attr('data-val', JSON.stringify(c));
                $('#c').val(c);
                showInternal(a, '#ao');
                showInternal(b, '#bo');
                showInternal(c, '#co');
                function showInternal(pv, elem) { $(elem).text('Internal Representation : ' + pv.toStringInternal()); }
            }
        }
        function moveanswer(from, to) {
            $(to).val($(from).val());                           // move toString
            $(to + 'o').text($(from + 'o').text());             // move toStringInternal
            $(to).attr('data-val', $(from).attr('data-val'));   // move json
        }
        function clean() {
            $('input').val('');
            $('output').html('');
            $('[data-val]').removeAttr('data-val');
        }
    </script>
</body>
</html>
