
<!--
   Author : Anthony John Ripa
   Date : 6/22/2016
   Demo for Laurent Polynomial & Multinomial : applications of the PlaceValue datatypes
-->

<!DOCTYPE html>
<html>
<head>
    <title>Computer Arithmetic System</title>
    <script type="text/javascript" src='https://code.jquery.com/jquery-latest.js'></script>
    <script type="text/javascript">
        window.jQuery || document.write("<script src='../../js/jquery.js'><" + "/script>")
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/1.7.0/math.min.js"></script>
    <script type="text/javascript">
        window.math || document.write("<script src='../../js/math.js'><" + "/script>")
    </script>
    <script type="text/javascript" src='complex.js'></script>
    <script type="text/javascript" src='wholeplacevaluecomplex2.js'></script>
    <script type="text/javascript" src='complexplacevalue.js'></script>
    <script type="text/javascript" src='complexlaurent.js'></script>
    <script type="text/javascript" src='complexexponential.js'></script>
    <script type="text/javascript" src='wholeplacevaluecomplex.js'></script>
    <script type="text/javascript" src='placevaluecomplex.js'></script>
    <script type="text/javascript" src='fourier.js'></script>
    <script type="text/javascript" src='placevalue.js'></script>
    <script type="text/javascript" src='laurent.js'></script>
    <script type="text/javascript" src='wholeplacevalue2.js'></script>
    <script type="text/javascript" src='wholeplacevalue.js'></script>   <!-- polynomial depends on wholeplacevalue 2015.7 -->
    <script type="text/javascript" src='polynomial.js'></script>        <!-- multinomial depends on polynomial 2015.7 -->
    <script type="text/javascript" src='multinomial.js'></script>
    <script type="text/javascript" src='placevalue2.js'></script>
    <script type="text/javascript" src='laurent2.js'></script>
    <script type="text/javascript" src='exponential.js'></script>
    <style>
        body,html { height:85% }
        body,input { font-family: "Arial Unicode MS" }
        h1 { text-align: center; margin: 0px }
        #f { position: absolute; top: 10px; left: 10px; }
        .main,.aux { width: 95%; border-spacing: 0; float: left; margin: 10px; }
        input { text-align: right; }
        td[width] { vertical-align: top }
    </style>
</head>
<body>
    <h1>Computer Algebra System</h1>
    <select id='f'><option>Polynomial</option><option>Laurent Polynomial</option><option>Multinomial</option><option selected>Laurent Multinomial</option><option>Complex Laurent Multinomial</option><option>Exponential</option><option>Fourier</option><option>Complex Exponential</option></select>
    <button onclick="compute()">=</button><input id='a' value='((x+h)^2-x^2)/h|0' />
    <hr style="clear:both"/>
    <div style="margin:auto;clear:both;overflow:scroll;width:95%;height:100%;border:5px solid #00aeef"></div>
    <script type="text/javascript">
        function nobr(x) {
            return "<span style='white-space:nowrap'>" + x + "</span>";
        }
        function compute() {
            f = [polynomial, laurent, multinomial, laurent2, complexlaurent, exponential, fourier, complexexponential][$('#f')[0].selectedIndex];   // Add Laurent  2015.8
            var poly = f.parse($('#a').val());
            var tuple = parse($('#a').val());
            $('div').append("<table class='main'><tr><td width='100%'>" + $('#a').val() + "</td><td>" + tupletostring(tuple) + "</td></tr><tr><td>" + poly + "</td><td style='text-align:right;float:right'>" + nobr(poly.tohtml()) + "</td></tr></table><hr style='clear:both'>"); // InOut<hr>InOut 2015.6 // tohtml 2015.7
        }
        function tupletostring(tuple) { // Replaced toStringInternal w/ tohtml  2015.7
            if (tuple.length == 1)
                return '<span style="color:blue">' + nobr(tuple[0].tohtml()) + '</span><hr>';	// In<hr>	2015.8
            else if (tuple.length == 2)
                return '<table class="aux"><tr><td style="color:red">' + tuple[0] + '</td><td style="color:blue;text-align:right;float:right">' + nobr(tuple[1].tohtml('cas.html >')) + '</td></tr></table><br clear="all"><hr>';		// OpIn<hr>	2015.8
            else
                return '<table class="aux"><tr><td></td><td style="color:green;text-align:right;float:right">' + nobr(tuple[1].tohtml()) + '</td></tr><tr><td style="color:red">' + tuple[0] + '</td><td style="color:blue;text-align:right;float:right">' + nobr(tuple[2].tohtml('cas.html >')) + '</td></tr></table><br clear="all"><hr>'; // InOpIn<hr>Out 2015.7
        }
        function parse(str) {
            var node = math.parse(str);
            if (node.type == 'OperatorNode') {
                console.log('CAS: OperatorNode')
                var kids = node.args;
                //var a = new f(kids[0].type == 'OperatorNode' ? kids[0] : kids[0].value || kids[0].name);
                var a = f.parse(kids[0]);     // f handles unpreprocessed kid 2015.11
                if (node.fn == 'unaryMinus' || node.fn == 'unaryPlus') {
                    return [node.op, a];
                } else {
                    //var b = new f(kids[1].type == 'OperatorNode' ? kids[1] : kids[1].value || kids[1].name);
                    var b = f.parse(kids[1]); // f handles unpreprocessed kid 2015.11
                }
            } else if (node.type == 'FunctionNode') {   // exponential  2015.11
                console.log('CAS: FunctionNode')
                return [node.name, laurent.parse(node.args[0])];
            } else {
                console.log('CAS: OtherNode')
                return [f.parse(node.value || node.name)];
            }
            if (f == multinomial) a.align(b);     // align    2015.7
            return [node.op, a, b];
        }
    </script>
</body>
</html>
