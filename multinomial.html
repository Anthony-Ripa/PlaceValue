
<!--
   Author : Anthony John Ripa
   Date : 1/20/2016
   Demo for Multinomial : a datatype for representing multinomials; an application of the WholePlaceValue2 datatype
-->

<!DOCTYPE html>
<html>
<head>
    <title>Multinomial Arithmetic</title>
    <script type="text/javascript" src='http://code.jquery.com/jquery-latest.js'></script>
    <script type="text/javascript">
        window.jQuery || document.write("<script src='../../js/jquery.js'><" + "/script>")
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/1.7.0/math.min.js"></script>
    <script type="text/javascript">
        window.math || document.write("<script src='../../js/math.js'><" + "/script>")
    </script>
    <script type="text/javascript" src='wholeplacevalue2.js'></script>
    <script type="text/javascript" src='wholeplacevalue.js'></script>   <!-- polynomial depends on wholeplacevalue 2015.7 -->
    <script type="text/javascript" src='polynomial.js'></script>        <!-- multinomial depends on polynomial 2015.7 -->
    <script type="text/javascript" src='multinomial.js'></script>
    <style>
        body,html { height:85% }
        body,input { font-family: "Arial Unicode MS" }
        .main,.aux { width: 95%; border-spacing: 0; float: left; margin: 10px; }
        input { text-align: right; }
        td[width] { vertical-align: top }
        h1 { text-align: center; margin: 0px }
    </style>
</head>
<body>
    <h1>Multinomial</h1>
    <button onclick="compute()">=</button><input id='a' value='((x+h)^2-x^2)/h|0' />
    <hr style="clear:both"/>
    <div style="margin:auto;clear:both;overflow:scroll;width:95%;height:100%;border:5px solid #00aeef"></div>
    <script type="text/javascript">
        function nobr(x) {
            return "<span style='white-space:nowrap'>" + x + "</span>";
        }
        function compute() {
            var poly = multinomial.parse($('#a').val());
            var tuple = parse($('#a').val());
            $('div').append("<table class='main'><tr><td width='100%'>" + $('#a').val() + "</td><td>" + tupletostring(tuple) + "</td></tr><tr><td>" + poly + "</td><td style='text-align:right;float:right'>" + nobr(poly.tohtml()) + "</td></tr></table><hr style='clear:both'>"); // InOut<hr>InOut 2015.6 // tohtml 2015.7
        }
        function tupletostring(tuple) { // Replaced toStringInternal w/ tohtml  2015.7
            if (tuple.length == 1)
                return '<span style="color:blue">'+nobr(tuple[0].tohtml())+'</span><hr>';	// In<hr>	2015.8
            else if (tuple.length == 2)
                return '<table class="aux"><tr><td style="color:red">' + tuple[0] + '</td><td style="color:blue;text-align:right;float:right">' + nobr(tuple[1].tohtml('multinomial.html >')) + '</td></tr></table><br clear="all"><hr>';		// OpIn<hr>	2015.8
            //else if (tuple[0] == '^')
            //    return nobr('(' + tuple[1].tohtml() + ') ^ ' + tuple[2].toString());
            else
                return '<table class="aux"><tr><td></td><td style="color:green;text-align:right;float:right">' + nobr(tuple[1].tohtml()) + '</td></tr><tr><td style="color:red">' + tuple[0] + '</td><td style="color:blue;text-align:right;float:right">' + nobr(tuple[2].tohtml('multinomial.html >')) + '</td></tr></table><br clear="all"><hr>'; // InOpIn<hr>Out 2015.7
        }
        function parse(str) {
            var node = math.parse(str);
            if (node.type != 'OperatorNode') {
                return [multinomial.parse(node.value || node.name)];
            } else if (node.type == 'OperatorNode') {
                console.log('OperatorNode')
                var kids = node.args;
                //var a = multinomial.parse(kids[0].type == 'OperatorNode' ? kids[0] : kids[0].value || kids[0].name);
                var a = multinomial.parse(kids[0]);       // multinomial handles unpreprocessed kid   2015.11
                if (node.fn == 'unaryMinus' || node.fn == 'unaryPlus') {
                    return [node.op, a];
                } else {
                    //var b = multinomial.parse(kids[1].type == 'OperatorNode' ? kids[1] : kids[1].value || kids[1].name);
                    var b = multinomial.parse(kids[1]);   // multinomial handles unpreprocessed kid   2015.11
                }
            }
            a.align(b);     // align    2015.7
            return [node.op, a, b];
        }
    </script>
</body>
</html>
